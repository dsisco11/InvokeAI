{
	"name": "InvokeAI::Dev",
	"build": {
		"dockerfile": "Dockerfile",
		"context": "../",
		"args": {
			"USERNAME": "node",
			"PYTHON_VERSION": "3.12",
			"INVOKEAI_ROOT": "/invokeai",
			"INVOKEAI_SRC": "/workspaces/InvokeAI"
		}
	},
	"mounts": [
		{// Setup a volume for all dependencies (pnpm, pip, uv, etc.)
			"type": "volume",
			"source": "dependency-cache",
			"target": "/home/node/.cache"
		},
		{// Setup a volume for the invokeai data (to prevent development work from corrupting users stable invokeai data)
			"type": "volume",
			"source": "invokeai-data-dev",
			"target": "/invokeai"
		},
		{// Insert the devcontainers vscode settings into the container
			"type": "bind",
			"source": "${localWorkspaceFolder}/.devcontainer/.vscode/",
			"target": "${containerWorkspaceFolder}/.vscode/"
		}
	],
	"features": {
		"ghcr.io/devcontainers/features/github-cli": {}
	},
	"hostRequirements": {
		"gpu": "optional",
		"cpus": 1,
		"memory": "8gb",
		"storage": "4gb"
	},
	"forwardPorts": [80, 9090],
	"portsAttributes": {
		"80": {"label": "InvokeAI Frontend"},
		"9090": {"label": "InvokeAI Backend"}
	},
	"updateContentCommand": {
		"Backend::Setup": "uv sync --dev && uv sync",
		"Frontend::Setup": "pnpm install --dir invokeai/frontend/web/ --frozen-lockfile --verbose"
	},
	"customizations": {
		"vscode": {
			"extensions": [
				"eamodio.gitlens",
				"ms-toolsai.jupyter",
				"ms-toolsai.vscode-jupyter-cell-tags",
				"ms-toolsai.jupyter-renderers",
				"ms-toolsai.vscode-jupyter-slideshow",
				"charliermarsh.ruff",
				"esbenp.prettier-vscode",
				"DavidAnson.vscode-markdownlint",
				"antfu.vite"
			]
		}
	}
}
